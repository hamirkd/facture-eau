<div class="flex w-full min-w-0 rounded-2xl flex-col">

    <div class="flex">
        <mat-form-field class="w-2/6 pr-2">
            <mat-label>Rechercher</mat-label>
            <input matInput (ngModelChange)="recherche($event)" ngModel="" [placeholder]="'Recherche avancée'">
        </mat-form-field>

        <div class="w-1/8 pl-2 text-left" style="align-self: center;">

            <button [routerLink]="['/pedagogie/eleve-moyenne-edit/'+salle_classe_id+'/'+trimestre]" routerLinkActive="router-link-active" class="shadow rounded-2xl overflow-hidden cursor-pointer mt-2 ml-2 bg-card  bg-red-900" mat-stroked-button>
                <mat-icon style="color: white;" svgIcon="iconsmind:pencil"></mat-icon> &nbsp;
                <label class="ml-0 cursor-pointer" style="color: white;"></label>
                </button>
        </div>

        <div class="w-4/6 pl-2 text-right" style="align-self: center;">

            <button (click)="calculerMoyenne()" class="shadow rounded-2xl overflow-hidden cursor-pointer mt-2 ml-2 bg-card  bg-red-900" mat-stroked-button>
                <mat-icon style="color: white;" svgIcon="iconsmind:refresh" [ngClass]="{'animate-spin-slow': actualiser['btn1']==true}" *ngIf="actualiser['btn1']==true"></mat-icon> &nbsp;
                <label class="ml-0 cursor-pointer" style="color: white;" *ngIf="!actualiser['btn1']">Calculer bulletin</label>
                </button>
            <button (click)="telechargerBulletin()" class="shadow rounded-2xl overflow-hidden cursor-pointer mt-2 ml-2 bg-card  bg-red-900" mat-stroked-button>
                        <mat-icon style="color: white;" svgIcon="iconsmind:refresh" [ngClass]="{'animate-spin-slow': actualiser['btn2']==true}" *ngIf="actualiser['btn2']==true"></mat-icon> &nbsp;
                        <label class="ml-0 cursor-pointer" style="color: white;" *ngIf="!actualiser['btn2']">Télécharger le bulletin</label>
                        </button>
            <button (click)="telechargerBulletinDeliberation()" class="shadow rounded-2xl overflow-hidden cursor-pointer mt-2 ml-2 bg-card  bg-red-900" mat-stroked-button>
                                <mat-icon style="color: white;" svgIcon="iconsmind:refresh" [ngClass]="{'animate-spin-slow': actualiser['btn3']==true}" *ngIf="actualiser['btn3']==true"></mat-icon> &nbsp;
                                <label class="ml-0 cursor-pointer" style="color: white;" *ngIf="!actualiser['btn3']">Télécharger délibération</label>
                                </button>

            <mat-form-field class="rounded-2xl cursor-pointer m-0 p-0 ml-2">
                <mat-select [formControl]="typefichier" class="m-0 p-0">
                    <mat-option [value]="'pdf'">PDF</mat-option>
                    <mat-option [value]="'xls'">XLS</mat-option>
                    <mat-option [value]="'doc'">DOC</mat-option>
                </mat-select>
            </mat-form-field>
        </div>
    </div>
    <div class="flex flex-col w-full pt-6 pb-6">

        <table mat-table [dataSource]="dataSource" class="mat-elevation-z1 w-full">

            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef> <b>No.</b> </th>
                <td mat-cell *matCellDef="let element">
                    <a class="whitespace-nowrap text-primary-500" [routerLink]="['/pedagogie/eleve-classe-detail/'+element.eleve_id]" routerLinkActive="router-link-active">{{element.eleve.matricule}} </a>

                </td>
            </ng-container>

            <ng-container matColumnDef="nomprenom">
                <th mat-header-cell *matHeaderCellDef> <b>Nom & Prénom</b> </th>
                <td mat-cell *matCellDef="let element"> {{element.eleve.nom}} {{element.eleve.prenom}} </td>
            </ng-container>
            <ng-container matColumnDef="rang">
                <th mat-header-cell *matHeaderCellDef> <b>Rang</b> </th>
                <td mat-cell *matCellDef="let element"> {{element?.bulletinMoyennes[0]?.bulletin?.rang}} </td>
            </ng-container>
            <ng-container matColumnDef="moyenne">
                <th mat-header-cell *matHeaderCellDef> <b>Moy.</b> </th>
                <td mat-cell *matCellDef="let element"> <b>{{element?.bulletinMoyennes[0]?.bulletin?.moyenne}}</b> </td>
            </ng-container>
            <ng-container *ngFor="let matiere of listeMatiere; let colIndex = index" matColumnDef="{{matiere.code}}">
                <th mat-header-cell *matHeaderCellDef> <b>{{matiere.code}}</b> </th>
                <td mat-cell *matCellDef="let element"> {{retournerMatiereNote(element.bulletinMoyennes,matiere.matiere_id)}}
                </td>
            </ng-container>

            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef> <b>Actions</b> </th>

                <td mat-cell *matCellDef="let element" class="text-justify">
                    <button class="hidden sm:inline-flex ml-3" mat-icon-button (click)="detail(element)">
                        <mat-icon svgIcon="heroicons_solid:eye"></mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns3"></tr>
            <tr mat-row *matRowDef="let element;let row; columns: displayedColumns3;"></tr>
        </table>
    </div>

</div>